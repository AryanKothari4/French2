<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>French Conjugation Quiz</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap');

        :root {
            --correct-color: #27ae60;
            --incorrect-color: #e74c3c;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Poppins', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #ff9a56 0%, #ffad56 25%, #c94b4b 75%, #8b0000 100%);
            background-attachment: fixed;
            color: #fff;
            padding: 20px;
        }

        .quiz-container {
            width: 100%;
            max-width: 500px;
            padding: 40px;
            background: rgba(255, 255, 255, 0.15);
            border-radius: 16px;
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            text-align: center;
            transition: opacity 0.3s ease, transform 0.3s ease;
        }

        h1, h2 { font-weight: 600; }
        h1 { margin-bottom: 10px; }

        #progress-counter, .setup-description { margin-bottom: 30px; font-weight: 300; opacity: 0.8; }
        #question-prompt { font-size: 1.2rem; margin-bottom: 10px; font-weight: 300; }
        #question-element { font-size: 2.5rem; margin-bottom: 30px; min-height: 60px; line-height: 1.2; }

        .input-group { display: flex; gap: 10px; flex-direction: column; }
        #answer-input { width: 100%; }
        #answer-input, .form-group select { 
            padding: 15px; 
            font-size: 1rem; 
            border-radius: 8px; 
            border: 1px solid rgba(255, 255, 255, 0.5); 
            background: rgba(255, 255, 255, 0.2); 
            color: #fff; 
            outline: none; 
            transition: all 0.2s ease; 
            font-family: 'Poppins', sans-serif; 
        }
        #answer-input::placeholder { color: rgba(255, 255, 255, 0.6); }
        #answer-input:focus, .form-group select:focus { 
            background: rgba(255, 255, 255, 0.3); 
            border-color: rgba(255, 255, 255, 0.8); 
        }
        #answer-input:disabled { opacity: 0.6; cursor: not-allowed; }

        .accent-guide {
            font-size: 0.85rem;
            opacity: 0.8;
            margin: 10px 0;
            text-align: center;
            line-height: 1.4;
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .form-group { margin-bottom: 30px; text-align: left; }
        .form-group label { margin-bottom: 5px; font-size: 0.9rem; opacity: 0.8; display: block; }
        .form-group select { width: 100%; }
        .form-group select option { background: #c94b4b; color: #fff; }

        button { 
            padding: 15px 25px; 
            font-size: 1rem; 
            font-weight: 600; 
            border: none; 
            border-radius: 8px; 
            background: #fff; 
            color: #c94b4b; 
            cursor: pointer; 
            transition: all 0.2s ease; 
            flex: 1;
        }
        button:hover { background: #f0f0f0; transform: translateY(-2px); }
        button:disabled { opacity: 0.5; cursor: not-allowed; transform: translateY(0); }

        #hint-button { 
            background: transparent; 
            border: 1px solid rgba(255, 255, 255, 0.6); 
            color: #fff; 
        }
        #hint-button:hover:not(:disabled) { background: rgba(255, 255, 255, 0.2); }

        #feedback-message { 
            min-height: 40px; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            margin-top: 20px; 
            font-weight: 600; 
        }
        .correct, .incorrect { 
            background-color: rgba(0, 0, 0, 0.6); 
            padding: 5px 15px; 
            border-radius: 8px; 
            animation: fadeIn 0.3s; 
        }
        .correct { color: var(--correct-color); }
        .incorrect { color: var(--incorrect-color); }
        .hint-message { font-size: 0.9rem; opacity: 0.8; font-weight: 400; }
        
        #continue-prompt { 
            display: none; 
            margin-top: 15px; 
            font-size: 0.9rem; 
            opacity: 0.7; 
            animation: fadeIn 0.5s; 
        }

        #quiz-box, #completion-screen { display: none; }
        #completion-screen { 
            flex-direction: column; 
            align-items: center; 
            justify-content: center; 
        }
        #completion-screen h2 { font-size: 2.5rem; margin-bottom: 20px; }
        #final-score { font-size: 1.2rem; margin-bottom: 30px; }

        #review-section { width: 100%; margin-top: 20px; text-align: left; }
        #review-section h3 { text-align: center; margin-bottom: 15px; font-weight: 400; }
        #wrong-answers-list { 
            list-style-type: none; 
            max-height: 150px; 
            overflow-y: auto; 
            background: rgba(0,0,0,0.2); 
            padding: 15px; 
            border-radius: 8px; 
        }
        #wrong-answers-list li { padding: 5px 0; border-bottom: 1px solid rgba(255,255,255,0.2); }
        #wrong-answers-list li:last-child { border-bottom: none; }

        @keyframes fadeIn { 
            from { opacity: 0; transform: scale(0.9); } 
            to { opacity: 1; transform: scale(1); } 
        }
    </style>
</head>
<body>
    <div class="quiz-container" id="selection-container">
        <h1>French Conjugation Quiz</h1>
        <p class="setup-description">Choose a conjugation type to practice.</p>
        <form id="start-quiz-form">
            <div class="form-group">
                <label for="tense-select">Choose Conjugation Type</label>
                <select id="tense-select">
                    <option value="present">Present Tense</option>
                    <option value="passe-compose">Passé Composé</option>
                    <option value="imparfait">Imparfait</option>
                </select>
            </div>
            <button type="submit">Start Quiz</button>
        </form>
    </div>

    <div class="quiz-container" id="quiz-box">
        <h1>French Conjugation Quiz</h1>
        <p id="progress-counter"></p>
        <div id="question-area">
            <p id="question-prompt">Conjugate the verb:</p>
            <h2 id="question-element"></h2>
        </div>
        <form id="answer-form">
            <div class="input-group">
                <input type="text" id="answer-input" placeholder="Type your conjugation..." autocomplete="off" autofocus>
                <div class="accent-guide">
                    Accents: 1→à  2→é  3→è  4→ê  5→ë  6→î  7→ï  8→ô  9→ù  0→û  -→ç  =→ÿ
                </div>
                <div class="button-group">
                    <button type="button" id="hint-button">Hint</button>
                    <button type="submit" id="check-button">Check</button>
                </div>
            </div>
        </form>
        <div id="feedback-message"></div>
        <p id="continue-prompt">Press Enter or click Continue</p>
    </div>

    <div class="quiz-container" id="completion-screen">
        <h2>Quiz Complete!</h2>
        <p id="final-score"></p>
        <div id="review-section" style="display: none;">
            <h3>Conjugations to Review:</h3>
            <ul id="wrong-answers-list"></ul>
        </div>
        <button id="restart-button">Quiz Again</button>
    </div>

    <script>
        // French verb conjugation data
        const verbData = {
            'present': {
                verbs: ['chanter', 'jouer', 'manger', 'commencer', 'envoyer', 's\'appeler', 'acheter', 'préférer', 'finir', 'vendre', 'aller', 'avoir', 'être', 'faire', 'venir', 'tenir', 'mettre', 'prendre', 'savoir', 'connaître', 'dire', 'écrire', 'lire', 'devoir', 'pouvoir', 'vouloir', 'dormir', 'partir', 'sortir', 'voir'],
                questionsPerVerb: 6 // all subjects
            },
            'passe-compose': {
                verbs: ['regarder', 'finir', 'vendre', 'être', 'vouloir', 'pouvoir', 'avoir', 'prendre', 'devoir', 'faire', 'mettre', 'descendre', 'retourner', 'monter', 'rester', 'sortir', 'venir', 'aller', 'naître', 'devenir', 'entrer', 'revenir', 'tomber', 'rentrer', 'arriver', 'mourir', 'partir', 'passer', 'nager', 'étudier', 'servir', 'dire', 'payer', 'voir', 'croire', 'écrire', 'lire'],
                questionsPerVerb: 2
            },
            'imparfait': {
                verbs: ['jouer', 'finir', 'grossir', 'être', 'attendre', 'vendre', 'étudier', 'chercher', 'nager', 'bouger', 'placer', 'faire', 'venir', 'dormir', 'mettre', 'voir', 'boire', 'sortir', 'vouloir', 'choisir', 'commencer'],
                questionsPerVerb: 2
            }
        };

        const subjects = ['je', 'tu', 'il/elle/on', 'nous', 'vous', 'ils/elles'];

        // Conjugation functions
        function conjugatePresent(verb, subject) {
            const conjugations = {
                'chanter': ['chante', 'chantes', 'chante', 'chantons', 'chantez', 'chantent'],
                'jouer': ['joue', 'joues', 'joue', 'jouons', 'jouez', 'jouent'],
                'manger': ['mange', 'manges', 'mange', 'mangeons', 'mangez', 'mangent'],
                'commencer': ['commence', 'commences', 'commence', 'commençons', 'commencez', 'commencent'],
                'envoyer': ['envoie', 'envoies', 'envoie', 'envoyons', 'envoyez', 'envoient'],
                's\'appeler': ['m\'appelle', 't\'appelles', 's\'appelle', 'nous appelons', 'vous appelez', 's\'appellent'],
                'acheter': ['achète', 'achètes', 'achète', 'achetons', 'achetez', 'achètent'],
                'préférer': ['préfère', 'préfères', 'préfère', 'préférons', 'préférez', 'préfèrent'],
                'finir': ['finis', 'finis', 'finit', 'finissons', 'finissez', 'finissent'],
                'vendre': ['vends', 'vends', 'vend', 'vendons', 'vendez', 'vendent'],
                'aller': ['vais', 'vas', 'va', 'allons', 'allez', 'vont'],
                'avoir': ['ai', 'as', 'a', 'avons', 'avez', 'ont'],
                'être': ['suis', 'es', 'est', 'sommes', 'êtes', 'sont'],
                'faire': ['fais', 'fais', 'fait', 'faisons', 'faites', 'font'],
                'venir': ['viens', 'viens', 'vient', 'venons', 'venez', 'viennent'],
                'tenir': ['tiens', 'tiens', 'tient', 'tenons', 'tenez', 'tiennent'],
                'mettre': ['mets', 'mets', 'met', 'mettons', 'mettez', 'mettent'],
                'prendre': ['prends', 'prends', 'prend', 'prenons', 'prenez', 'prennent'],
                'savoir': ['sais', 'sais', 'sait', 'savons', 'savez', 'savent'],
                'connaître': ['connais', 'connais', 'connaît', 'connaissons', 'connaissez', 'connaissent'],
                'dire': ['dis', 'dis', 'dit', 'disons', 'dites', 'disent'],
                'écrire': ['écris', 'écris', 'écrit', 'écrivons', 'écrivez', 'écrivent'],
                'lire': ['lis', 'lis', 'lit', 'lisons', 'lisez', 'lisent'],
                'devoir': ['dois', 'dois', 'doit', 'devons', 'devez', 'doivent'],
                'pouvoir': ['peux', 'peux', 'peut', 'pouvons', 'pouvez', 'peuvent'],
                'vouloir': ['veux', 'veux', 'veut', 'voulons', 'voulez', 'veulent'],
                'dormir': ['dors', 'dors', 'dort', 'dormons', 'dormez', 'dorment'],
                'partir': ['pars', 'pars', 'part', 'partons', 'partez', 'partent'],
                'sortir': ['sors', 'sors', 'sort', 'sortons', 'sortez', 'sortent'],
                'voir': ['vois', 'vois', 'voit', 'voyons', 'voyez', 'voient']
            };
            const subjectIndex = subjects.indexOf(subject);
            return conjugations[verb][subjectIndex];
        }

        function conjugatePasseCompose(verb, subject) {
            const etreVerbs = ['aller', 'venir', 'arriver', 'partir', 'sortir', 'entrer', 'rentrer', 'retourner', 'tomber', 'rester', 'monter', 'descendre', 'naître', 'mourir', 'devenir', 'revenir'];
            const pastParticiples = {
                'regarder': 'regardé', 'finir': 'fini', 'vendre': 'vendu', 'être': 'été', 'vouloir': 'voulu',
                'pouvoir': 'pu', 'avoir': 'eu', 'prendre': 'pris', 'devoir': 'dû', 'faire': 'fait',
                'mettre': 'mis', 'descendre': 'descendu', 'retourner': 'retourné', 'monter': 'monté',
                'rester': 'resté', 'sortir': 'sorti', 'venir': 'venu', 'aller': 'allé', 'naître': 'né',
                'devenir': 'devenu', 'entrer': 'entré', 'revenir': 'revenu', 'tomber': 'tombé',
                'rentrer': 'rentré', 'arriver': 'arrivé', 'mourir': 'mort', 'partir': 'parti',
                'passer': 'passé', 'nager': 'nagé', 'étudier': 'étudié', 'servir': 'servi',
                'dire': 'dit', 'payer': 'payé', 'voir': 'vu', 'croire': 'cru', 'écrire': 'écrit', 'lire': 'lu'
            };

            const avoirConjugations = ['ai', 'as', 'a', 'avons', 'avez', 'ont'];
            const etreConjugations = ['suis', 'es', 'est', 'sommes', 'êtes', 'sont'];
            
            const subjectIndex = subjects.indexOf(subject);
            const pastParticiple = pastParticiples[verb];
            
            if (etreVerbs.includes(verb)) {
                return `${etreConjugations[subjectIndex]} ${pastParticiple}`;
            } else {
                return `${avoirConjugations[subjectIndex]} ${pastParticiple}`;
            }
        }

        function conjugateImparfait(verb, subject) {
            const conjugations = {
                'jouer': ['jouais', 'jouais', 'jouait', 'jouions', 'jouiez', 'jouaient'],
                'finir': ['finissais', 'finissais', 'finissait', 'finissions', 'finissiez', 'finissaient'],
                'grossir': ['grossissais', 'grossissais', 'grossissait', 'grossissions', 'grossissiez', 'grossissaient'],
                'être': ['étais', 'étais', 'était', 'étions', 'étiez', 'étaient'],
                'attendre': ['attendais', 'attendais', 'attendait', 'attendions', 'attendiez', 'attendaient'],
                'vendre': ['vendais', 'vendais', 'vendait', 'vendions', 'vendiez', 'vendaient'],
                'étudier': ['étudiais', 'étudiais', 'étudiait', 'étudiions', 'étudiiez', 'étudiaient'],
                'chercher': ['cherchais', 'cherchais', 'cherchait', 'cherchions', 'cherchiez', 'cherchaient'],
                'nager': ['nageais', 'nageais', 'nageait', 'nagions', 'nagiez', 'nageaient'],
                'bouger': ['bougeais', 'bougeais', 'bougeait', 'bougions', 'bougiez', 'bougeaient'],
                'placer': ['plaçais', 'plaçais', 'plaçait', 'placions', 'placiez', 'plaçaient'],
                'faire': ['faisais', 'faisais', 'faisait', 'faisions', 'faisiez', 'faisaient'],
                'venir': ['venais', 'venais', 'venait', 'venions', 'veniez', 'venaient'],
                'dormir': ['dormais', 'dormais', 'dormait', 'dormions', 'dormiez', 'dormaient'],
                'mettre': ['mettais', 'mettais', 'mettait', 'mettions', 'mettiez', 'mettaient'],
                'voir': ['voyais', 'voyais', 'voyait', 'voyions', 'voyiez', 'voyaient'],
                'boire': ['buvais', 'buvais', 'buvait', 'buvions', 'buviez', 'buvaient'],
                'sortir': ['sortais', 'sortais', 'sortait', 'sortions', 'sortiez', 'sortaient'],
                'vouloir': ['voulais', 'voulais', 'voulait', 'voulions', 'vouliez', 'voulaient'],
                'choisir': ['choisissais', 'choisissais', 'choisissait', 'choisissions', 'choisissiez', 'choisissaient'],
                'commencer': ['commençais', 'commençais', 'commençait', 'commencions', 'commenciez', 'commençaient']
            };
            const subjectIndex = subjects.indexOf(subject);
            return conjugations[verb][subjectIndex];
        }

        function getCorrectConjugation(verb, subject, tense) {
            switch(tense) {
                case 'present': return conjugatePresent(verb, subject);
                case 'passe-compose': return conjugatePasseCompose(verb, subject);
                case 'imparfait': return conjugateImparfait(verb, subject);
                default: return '';
            }
        }

        // DOM elements
        const selectionContainer = document.getElementById('selection-container');
        const startQuizForm = document.getElementById('start-quiz-form');
        const tenseSelect = document.getElementById('tense-select');
        const quizBox = document.getElementById('quiz-box');
        const completionScreen = document.getElementById('completion-screen');
        const progressCounter = document.getElementById('progress-counter');
        const questionElement = document.getElementById('question-element');
        const answerForm = document.getElementById('answer-form');
        const answerInput = document.getElementById('answer-input');
        const checkButton = document.getElementById('check-button');
        const hintButton = document.getElementById('hint-button');
        const feedbackMessage = document.getElementById('feedback-message');
        const continuePrompt = document.getElementById('continue-prompt');
        const restartButton = document.getElementById('restart-button');
        const finalScore = document.getElementById('final-score');
        const reviewSection = document.getElementById('review-section');
        const wrongAnswersList = document.getElementById('wrong-answers-list');

        let currentTense = 'present';
        let quizQuestions = [];
        let currentQuestion = null;
        let totalQuestions = 0;
        let isWaitingForContinue = false;
        let wronglyAnswered = [];

        // Accent mark handling
        const accentMap = {
            '1': 'à', '2': 'é', '3': 'è', '4': 'ê', '5': 'ë',
            '6': 'î', '7': 'ï', '8': 'ô', '9': 'ù', '0': 'û',
            '-': 'ç', '=': 'ÿ'
        };

        answerInput.addEventListener('keydown', function(event) {
            if (accentMap[event.key]) {
                event.preventDefault();
                const cursorPos = this.selectionStart;
                const currentValue = this.value;
                this.value = currentValue.slice(0, cursorPos) + accentMap[event.key] + currentValue.slice(cursorPos);
                this.selectionStart = this.selectionEnd = cursorPos + 1;
            }
        });

        function generateQuestions(tense) {
            const data = verbData[tense];
            const questions = [];
            
            data.verbs.forEach(verb => {
                if (data.questionsPerVerb === 6) {
                    // Present tense: all subjects
                    subjects.forEach(subject => {
                        questions.push({ verb, subject });
                    });
                } else {
                    // Passé composé and imparfait: 2 random subjects
                    const usedSubjects = [];
                    for (let i = 0; i < data.questionsPerVerb; i++) {
                        let randomSubject;
                        do {
                            randomSubject = subjects[Math.floor(Math.random() * subjects.length)];
                        } while (usedSubjects.includes(randomSubject));
                        usedSubjects.push(randomSubject);
                        questions.push({ verb, subject: randomSubject });
                    }
                }
            });
            
            return questions;
        }

        function startGame(tense) {
            currentTense = tense;
            quizQuestions = generateQuestions(tense);
            totalQuestions = quizQuestions.length;
            wronglyAnswered = [];
            
            // Shuffle questions
            for (let i = quizQuestions.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [quizQuestions[i], quizQuestions[j]] = [quizQuestions[j], quizQuestions[i]];
            }
            
            selectionContainer.style.display = 'none';
            completionScreen.style.display = 'none';
            quizBox.style.display = 'block';
            nextQuestion();
        }

        function nextQuestion() {
            if (quizQuestions.length === 0) {
                endGame();
                return;
            }
            
            isWaitingForContinue = false;
            feedbackMessage.innerHTML = '';
            continuePrompt.style.display = 'none';
            checkButton.textContent = 'Check';
            answerInput.disabled = false;
            hintButton.disabled = false;
            answerInput.value = '';
            
            progressCounter.textContent = `${quizQuestions.length} / ${totalQuestions} questions remaining`;
            
            currentQuestion = quizQuestions[0];
            questionElement.textContent = `${currentQuestion.subject} ${currentQuestion.verb}`;
            answerInput.focus();
        }

        function checkAnswer(event) {
            event.preventDefault();
            if (isWaitingForContinue) {
                nextQuestion();
                return;
            }
            
            const userAnswer = answerInput.value.trim().toLowerCase();
            if (!userAnswer) return;
            
            const correctAnswer = getCorrectConjugation(currentQuestion.verb, currentQuestion.subject, currentTense);
            const isCorrect = userAnswer === correctAnswer.toLowerCase();
            
            if (isCorrect) {
                feedbackMessage.innerHTML = `<span class="correct">Correct!</span>`;
                quizQuestions.shift();
                answerInput.disabled = true;
                hintButton.disabled = true;
                setTimeout(nextQuestion, 600);
            } else {
                feedbackMessage.innerHTML = `<span class="incorrect">Incorrect. The answer is: ${correctAnswer}</span>`;
                wronglyAnswered.push({
                    verb: currentQuestion.verb,
                    subject: currentQuestion.subject,
                    correctAnswer: correctAnswer,
                    userAnswer: userAnswer
                });
                quizQuestions.shift();
                isWaitingForContinue = true;
                answerInput.disabled = true;
                hintButton.disabled = true;
                checkButton.textContent = 'Continue';
                continuePrompt.style.display = 'block';
                checkButton.focus();
            }
        }

        function showHint() {
            if (currentQuestion && !isWaitingForContinue) {
                const correctAnswer = getCorrectConjugation(currentQuestion.verb, currentQuestion.subject, currentTense);
                const hintLength = Math.min(2, correctAnswer.length);
                const hint = correctAnswer.substring(0, hintLength);
                feedbackMessage.innerHTML = `<span class="hint-message">Hint: Starts with "${hint}..."</span>`;
                hintButton.disabled = true;
                answerInput.focus();
            }
        }

        function endGame() {
            quizBox.style.display = 'none';
            
            if (wronglyAnswered.length === 0) {
                finalScore.textContent = `Perfect score! You didn't miss any questions.`;
                reviewSection.style.display = 'none';
            } else {
                finalScore.textContent = `You missed ${wronglyAnswered.length} out of ${totalQuestions} questions.`;
                wrongAnswersList.innerHTML = '';
                wronglyAnswered.forEach(item => {
                    const listItem = document.createElement('li');
                    listItem.textContent = `${item.subject} ${item.verb} → ${item.correctAnswer}`;
                    wrongAnswersList.appendChild(listItem);
                });
                reviewSection.style.display = 'block';
            }
            
            completionScreen.style.display = 'flex';
        }

        function resetToSelection() {
            completionScreen.style.display = 'none';
            selectionContainer.style.display = 'block';
        }

        // Event listeners
        startQuizForm.addEventListener('submit', function(event) {
            event.preventDefault();
            const selectedTense = tenseSelect.value;
            startGame(selectedTense);
        });

        answerForm.addEventListener('submit', checkAnswer);
        hintButton.addEventListener('click', showHint);
        restartButton.addEventListener('click', resetToSelection);
    </script>
</body>
</html>
